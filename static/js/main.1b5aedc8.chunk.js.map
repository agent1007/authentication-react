{"version":3,"sources":["images/logo-header.svg","components/Header/header.js","components/Footer/Footer.js","components/hooks/useForm.js","components/Register/Register.js","components/Login/Login.js","components/contexts/CurrentUserContext.js","utils/MainApi.js","utils/auth.js","components/App/App.js","reportWebVitals.js","index.js"],"names":["Header","path","className","src","logo","alt","Footer","href","target","rel","useFormWithValidation","useState","values","setValues","errors","setErrors","isValid","setIsValid","resetForm","useCallback","newValues","newErrors","newIsValid","handleChange","evt","input","name","value","validationMessage","closest","checkValidity","Register","onRegister","history","useHistory","onSubmit","e","preventDefault","password","email","then","push","catch","err","console","log","type","id","onChange","minLength","maxLength","pattern","required","disabled","to","Login","onLogin","CurrentUserContext","React","createContext","mainApi","baseUrl","this","_baseUrl","res","ok","json","Promise","reject","status","fetch","headers","authorization","localStorage","getItem","_requestResult","BASE_URL","responseCheck","response","App","location","useLocation","loggedIn","setLoggedIn","setData","currentUser","setCurrentUser","tokenCheck","getUserData","pathname","useEffect","data","Provider","method","body","JSON","stringify","auth","statusCode","Error","token","setItem","reportWebVitals","onPerfEntry","Function","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.1b5aedc8.chunk.js","sourcesContent":["export default __webpack_public_path__ + \"static/media/logo-header.4410338f.svg\";","import { Route } from 'react-router-dom';\r\nimport logo from '../../images/logo-header.svg';\r\n\r\n\r\nfunction Header() {\r\n  return (\r\n    <>\r\n      <Route path=\"/signup\">\r\n        <header className=\"header header_register\">\r\n          <img className=\"header__logo header__logo_dark-theme\" src={logo} alt=\"Логотип\" />\r\n          <h1 className=\"header__title\">Добро пожаловать!</h1>\r\n        </header>\r\n      </Route>\r\n      <Route path=\"/signin\">\r\n        <header className=\"header header_register\">\r\n          <img className=\"header__logo header__logo_dark-theme\" src={logo} alt=\"Логотип\" />\r\n          <h1 className=\"header__title\">Рады видеть!</h1>\r\n        </header>\r\n      </Route>\r\n\r\n    </>\r\n  );\r\n}\r\n\r\nexport default Header;","function Footer() {\r\n\r\n  \r\n    return (\r\n        <footer className=\"footer\">\r\n            <h2 className=\"footer__title\">Учебный проект Яндекс.Практикум х BeatFilm.</h2>\r\n            <div className=\"footer__container\">\r\n                <p className=\"footer__copyright\">© 2021</p>\r\n                <nav>\r\n                <ul className=\"footer__links\">\r\n                    <li><a className=\"footer__link\" href=\"https://praktikum.yandex.ru\" target=\"_blank\" rel=\"noreferrer\">Яндекс.Практикум</a></li>\r\n                    <li><a className=\"footer__link\" href=\"https://github.com/\" target=\"_blank\" rel=\"noreferrer\">Github</a></li>\r\n                    <li><a className=\"footer__link\" href=\"https://www.facebook.com/\" target=\"_blank\" rel=\"noreferrer\">Facebook</a></li>\r\n                </ul>\r\n                </nav>\r\n            </div>\r\n        </footer>\r\n    );\r\n}\r\n  \r\nexport default Footer;","import { useState, useCallback } from 'react';\r\n\r\nexport function useForm() {\r\n    const [values, setValues] = useState({});\r\n\r\n    const handleChange = (evt) => {\r\n        const input = evt.target;\r\n        const name = input.name;\r\n        const value = input.value;\r\n\r\n        setValues({ ...values, [name]: value })\r\n    }\r\n    return { values, handleChange, setValues }\r\n}\r\n\r\nexport function useFormWithValidation() {\r\n    const [values, setValues] = useState({});\r\n    const [errors, setErrors] = useState({});\r\n    const [isValid, setIsValid] = useState(false);\r\n\r\n    const handleChange = (evt) => {\r\n        const input = evt.target;\r\n        const name = input.name;\r\n        const value = input.value;\r\n\r\n        setValues({ ...values, [name]: value });\r\n        setErrors({ ...errors, [name]: input.validationMessage });\r\n        setIsValid(input.closest('form').checkValidity());\r\n    }\r\n\r\n    const resetForm = useCallback(\r\n        (newValues = {}, newErrors = {}, newIsValid = false) => {\r\n            setValues(newValues);\r\n            setErrors(newErrors);\r\n            setIsValid(newIsValid);\r\n        },\r\n        [setValues, setErrors, setIsValid]\r\n    );\r\n\r\n    return { values, errors, isValid, handleChange, setValues, resetForm }\r\n}","\r\nimport { Link, useHistory } from 'react-router-dom';\r\nimport { useFormWithValidation } from '../hooks/useForm';\r\n\r\nfunction Register({ onRegister }) {\r\n  const history = useHistory();\r\n  const { values, handleChange, resetForm, errors, isValid } = useFormWithValidation();\r\n\r\n  const handleSubmit = (e) => {\r\n    e.preventDefault();\r\n    \r\n    if (!values.password || !values.email) {\r\n      return;\r\n    }\r\n    onRegister(values)\r\n      .then(resetForm)\r\n      .then(() => history.push('/movies'))\r\n\r\n      .catch(err => console.log(err))\r\n  }\r\n\r\n  return (\r\n    <div className=\"register\">\r\n      <form className=\"register__form\" onSubmit={handleSubmit}>\r\n        <div className=\"register__inputs\">\r\n          <div className=\"register__input-container\">\r\n            <p className=\"register__input-text\">Имя</p>\r\n            <input\r\n              type=\"text\"\r\n              name='name'\r\n              className=\"register__input\"\r\n              id=\"name\"\r\n              value={values.name || ''}\r\n              onChange={handleChange}\r\n              minLength='2'\r\n              maxLength='40'\r\n              pattern='[a-zA-Zа-яА-Я -]{1,}'\r\n              required\r\n            />\r\n            <span\r\n              id=\"name-error\"\r\n              className=\"error error_register\"\r\n            > {errors.name || ''}</span>\r\n          </div>\r\n          <div className=\"register__input-container\">\r\n            <p className=\"register__input-text\">E-mail</p>\r\n            <input\r\n              type=\"email\"\r\n              name='email'\r\n              className=\"register__input\"\r\n              id=\"email\"\r\n              value={values.email || ''}\r\n              onChange={handleChange}\r\n              required minLength={2} maxLength={40}\r\n            />\r\n            <span\r\n              id=\"email-error\"\r\n              className=\"error error_register\"\r\n            > {errors.email || ''}</span>\r\n          </div>\r\n          <div className=\"register__input-container\">\r\n            <p className=\"register__input-text\">Пароль</p>\r\n            <input\r\n              type=\"password\"\r\n              name='password'\r\n              className=\"register__input\"\r\n              id=\"password\"\r\n              value={values.password || ''}\r\n              onChange={handleChange}\r\n              required minLength={2} maxLength={40}\r\n            />\r\n            <span\r\n              id=\"password-error\"\r\n              className=\"error error_register\"\r\n            > {errors.password || ''}</span>\r\n          </div>\r\n        </div>\r\n        <button\r\n          type=\"submit\"\r\n          className={`register__submit-button ${!isValid && \"register__submit-button_disabled\"\r\n            }`}\r\n          disabled={!isValid}\r\n        >Зарегистрироваться\r\n        </button>\r\n      </form>\r\n      <div className=\"register__container\">\r\n        <p className=\"regiser__text\">Уже зарегистрированы?</p>\r\n        <Link to=\"/signin\" className=\"regiser__link\">Войти</Link>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default Register;","import { Link, useHistory } from 'react-router-dom';\r\nimport { useFormWithValidation } from '../hooks/useForm';\r\n\r\nfunction Login({ onLogin }) {\r\n  const { values, handleChange, resetForm, errors, isValid } = useFormWithValidation();\r\n  const history = useHistory();\r\n\r\n  const handleSubmit = (e) => {\r\n    e.preventDefault();\r\n    if (!values.password || !values.email) {\r\n      return;\r\n    }\r\n    onLogin(values)\r\n      .then(resetForm)\r\n      .then(() => history.push('/movies'))\r\n      .catch((err) => console.log(err))\r\n  }\r\n\r\n  return (\r\n    <div className=\"register\">\r\n      <form className=\"register__form\" onSubmit={handleSubmit}>\r\n        <div className=\"register__inputs\">\r\n          <div className=\"register__input-container\">\r\n            <p className=\"register__input-text\">E-mail</p>\r\n            <input\r\n              type=\"email\"\r\n              name='email'\r\n              className=\"register__input\"\r\n              id=\"email\"\r\n              value={values.email || ''}\r\n              onChange={handleChange}\r\n              required minLength={2} maxLength={40}\r\n            />\r\n            <span\r\n              id=\"email-error\"\r\n              className=\"error error_register\"\r\n            > {errors.email || ''}</span>\r\n          </div>\r\n          <div className=\"register__input-container\">\r\n            <p className=\"register__input-text\">Пароль</p>\r\n            <input\r\n              type=\"password\"\r\n              name='password'\r\n              className=\"register__input\"\r\n              id=\"password\"\r\n              value={values.password || ''}\r\n              onChange={handleChange}\r\n              required minLength={2} maxLength={40}\r\n            />\r\n            <span\r\n              id=\"password-error\"\r\n              className=\"error error_register\"\r\n            > {errors.password || ''}</span>\r\n          </div>\r\n        </div>\r\n        <button\r\n          type=\"submit\"\r\n          className={`register__submit-button ${!isValid && \"register__submit-button_disabled\"\r\n            }`}\r\n          disabled={!isValid}\r\n        >Войти\r\n        </button>\r\n      </form>\r\n      <div className=\"register__container\">\r\n        <p className=\"regiser__text\">Ещё не зарегистрированы?</p>\r\n        <Link to=\"/signup\" className=\"regiser__link\">Регистрация</Link>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default Login;","import React from 'react';\r\nexport const CurrentUserContext = React.createContext();","class MainApi {\r\n  constructor({ baseUrl }) {\r\n    this._baseUrl = baseUrl;\r\n  };\r\n\r\n  _requestResult(res) {\r\n    if (res.ok) {\r\n      return res.json();\r\n    }\r\n    return Promise.reject(`Что-то пошло не так: ${res.status}`);\r\n  }\r\n\r\n  getUserData() {\r\n    return fetch(`${this._baseUrl}/users/me`, {\r\n      headers: {\r\n        authorization: `Bearer ${localStorage.getItem('jwt')}`,\r\n      }\r\n    })\r\n      .then((res) => this._requestResult(res))\r\n  }\r\n\r\n}\r\n\r\nconst mainApi = new MainApi({\r\n  baseUrl: 'http://localhost:3000'\r\n})\r\n\r\n\r\nexport default mainApi;","export const BASE_URL = 'http://localhost:3000';\r\n\r\nconst responseCheck = (response) => response.ok ? response.json() : Promise.reject(`Ошибка ${response.status}`);\r\n\r\nexport const register = (name, email, password) => {\r\n  return fetch(`${BASE_URL}/signup`, {\r\n    method: 'POST',\r\n    headers: {\r\n      'Content-Type': 'application/json'\r\n    },\r\n    body: JSON.stringify({name, email, password})\r\n  })\r\n  .then(responseCheck)\r\n};\r\n\r\nexport const login = (email, password) => {\r\n  return fetch(`${BASE_URL}/signin`, {\r\n    method: 'POST',\r\n    headers: {\r\n      'Content-Type': 'application/json'\r\n    },\r\n    body: JSON.stringify({email, password})\r\n  })\r\n  .then(responseCheck)\r\n  \r\n};","import Header from '../Header/header';\nimport Footer from '../Footer/Footer';\nimport Register from '../Register/Register';\nimport Login from '../Login/Login';\nimport { Route, Switch, useHistory, useLocation } from 'react-router-dom';\nimport { useState, useEffect, useCallback } from 'react';\nimport { CurrentUserContext } from '../contexts/CurrentUserContext';\nimport mainApi from '../../utils/MainApi';\nimport * as auth from '../../utils/auth';\n\n\nfunction App() {\n\n  const initialData = {\n    name: '',\n    email: '',\n    password: ''\n  }\n  const history = useHistory();\n  const location = useLocation();\n\n  const [loggedIn, setLoggedIn] = useState(false);\n  const [data, setData] = useState(initialData)\n  const [currentUser, setCurrentUser] = useState({});\n\n  const handleRegister = ({ name, email, password }) => {\n    return auth.register(name, email, password)\n      .then((res) => {\n        history.push('/movies');\n        return res;\n      })\n  }\n\n  const handleLogin = ({ email, password }) => {\n    return auth.login(email, password)\n      .then(res => {\n        if (!res || res.statusCode === 400) throw new Error('Что-то пошло не так');\n        if (res.token) {\n          setData({ email })\n          localStorage.setItem('jwt', res.token);\n          setLoggedIn(true);\n        };\n      })\n  }\n\n  const tokenCheck = useCallback(() => {\n    const jwt = localStorage.getItem('jwt');\n    if (jwt) {\n      mainApi.getUserData()\n        .then((res) => {\n          if (res) {\n            setData({\n              name: res.name,\n              email: res.email,\n            })\n            setLoggedIn(true);\n            history.push(location.pathname)\n          }\n        })\n        .catch((res) => {\n          history.push('/signin')\n        })\n    }\n  }, [history])\n\n  useEffect(() => {\n    tokenCheck();\n  }, [tokenCheck])\n\n\n  useEffect(() => {\n    if (loggedIn) {\n      mainApi.getUserData()\n        .then(data => {\n          setCurrentUser(data);\n        })\n        .catch(err => console.log(err))\n    }\n  }, [loggedIn])\n\n\n\n  return (\n    <div className=\"App\">\n      <CurrentUserContext.Provider value={currentUser}>\n        <div className=\"body\">\n\n          <div className=\"page\">\n            <Header />\n            <Switch>\n              <Route path=\"/signin\">\n                <Login\n                  onLogin={handleLogin} />\n              </Route>\n\n              <Route path=\"/signup\">\n                <Register\n                  onRegister={handleRegister} />\n              </Route>\n            </Switch>\n          </div>\n          <Footer />\n        </div>\n      </CurrentUserContext.Provider>\n    </div>\n  );\n}\n\nexport default App;\n\n\n\n","const reportWebVitals = onPerfEntry => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './components/App/App';\nimport reportWebVitals from './reportWebVitals';\nimport { BrowserRouter } from 'react-router-dom';\n\n\nReactDOM.render(\n  <React.StrictMode>\n    <BrowserRouter> \n      <App />\n      </BrowserRouter> \n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\nreportWebVitals();\n"],"sourceRoot":""}